<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>一个angular指令加载顺序异常的排除 - Mosby</title><link rel="manifest" href="/manifest.json"><meta name="theme-color" content="#000000"><meta name="application-name" content="Mosby Zhou Blog"><meta name="msapplication-TileImage" content="/img/favicon.png"><meta name="msapplication-TileColor" content="#000000"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Mosby Zhou Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><link rel="apple-touch-icon" sizes="256x256" href="/img/favicon.png"><meta name="description" content="angularcss 和 directive 加载顺序的研究"><meta property="og:type" content="blog"><meta property="og:title" content="Mosby Zhou Blog"><meta property="og:url" content="https://mosby-zhou.github.io/2016/09-04-angularjs-css-directive-link-error/"><meta property="og:site_name" content="Mosby"><meta property="og:description" content="angularcss 和 directive 加载顺序的研究"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://mosby-zhou.github.io/images/more-teacher.jpg"><meta property="og:image" content="https://mosby-zhou.github.io/images/more-teacher.jpg"><meta property="article:published_time" content="2016-09-04T09:04:33.000Z"><meta property="article:modified_time" content="2016-09-09T20:35:11.000Z"><meta property="article:author" content="Mosby"><meta property="article:tag" content="javascript"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/images/more-teacher.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://mosby-zhou.github.io/2016/09-04-angularjs-css-directive-link-error/"},"headline":"一个angular指令加载顺序异常的排除","image":["https://mosby-zhou.github.io/images/more-teacher.jpg","https://mosby-zhou.github.io/images/more-teacher.jpg"],"datePublished":"2016-09-04T09:04:33.000Z","dateModified":"2016-09-09T20:35:11.000Z","author":{"@type":"Person","name":"Mosby"},"publisher":{"@type":"Organization","name":"Mosby","logo":{"@type":"ImageObject","url":"https://mosby-zhou.github.io/img/logo.png"}},"description":"angularcss 和 directive 加载顺序的研究"}</script><link rel="canonical" href="https://mosby-zhou.github.io/2016/09-04-angularjs-css-directive-link-error/"><link rel="icon" href="/img/favicon.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/monokai-sublime.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.png" alt="Mosby" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="GitHub" href="https://github.com/mosby-zhou"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2016-09-04T09:04:33.000Z" title="9/4/2016, 9:04:33 AM">2016-09-04</time>发表</span><span class="level-item"><time dateTime="2016-09-09T20:35:11.000Z" title="9/9/2016, 8:35:11 PM">2016-09-10</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Web/">Web</a><span> / </span><a class="link-muted" href="/categories/Web/Angularjs/">Angularjs</a></span><span class="level-item">13 分钟读完 (大约1908个字)</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">一个angular指令加载顺序异常的排除</h1><div class="content"><h3 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h3><p>在表格展示的时候, 有些状态需要切换的, 之前都是直接使用的 checkbox. 有天老大说要优化界面, 把大部分的 checkbox 换成仿 iOS 的 SwitchButton, 开始想得很简单嘛, 新建了一个指令, 考虑了下使用场景和情况, 减少使用成本, 使用方法和原始 input 差不多, 很快就完工了.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> switchBtn = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">restrict</span>: <span class="string">&#x27;A&#x27;</span>,</span><br><span class="line">    <span class="attr">templateUrl</span>: <span class="string">&#x27;views/common/switchBtn.html&#x27;</span>,</span><br><span class="line">    <span class="attr">css</span>: &#123; <span class="attr">href</span>: <span class="string">&#x27;styles/common/switchBtn.css&#x27;</span>, <span class="attr">persist</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">    <span class="attr">replace</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">scope</span>: &#123;</span><br><span class="line">      <span class="comment">//传入的ng-model至少是双层结构(至少有个.)</span></span><br><span class="line">      <span class="attr">ngModel</span>: <span class="string">&#x27;=&#x27;</span>,</span><br><span class="line">      <span class="attr">firstStatus</span>: <span class="string">&#x27;@&#x27;</span>,</span><br><span class="line">      <span class="attr">onChange</span>: <span class="string">&#x27;=&#x27;</span>,</span><br><span class="line">      <span class="attr">text</span>: <span class="string">&#x27;=&#x27;</span>,</span><br><span class="line">      <span class="attr">noText</span>: <span class="string">&#x27;=&#x27;</span>,</span><br><span class="line">      <span class="attr">item</span>: <span class="string">&#x27;=&#x27;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">controller</span>: <span class="function"><span class="keyword">function</span> (<span class="params">$scope</span>) </span>&#123;&#125;,</span><br><span class="line">    <span class="attr">link</span>: <span class="function"><span class="keyword">function</span> (<span class="params">$scope, $element, $attrs</span>) </span>&#123;</span><br><span class="line">      $element.on(<span class="string">&#x27;selectstart&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="keyword">var</span> firstStatus = <span class="literal">false</span>;</span><br><span class="line">      <span class="keyword">if</span> ($scope.firstStatus &amp;&amp; $scope.firstStatus.toLowerCase() == <span class="string">&#x27;false&#x27;</span>) &#123;</span><br><span class="line">        firstStatus = <span class="literal">false</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> ($scope.firstStatus &amp;&amp; $scope.firstStatus.toLowerCase() == <span class="string">&#x27;true&#x27;</span>) &#123;</span><br><span class="line">        firstStatus = <span class="literal">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> $scope.ngModel != <span class="string">&#x27;undefined&#x27;</span> &amp;&amp; $scope.ngModel != <span class="literal">null</span>) &#123;</span><br><span class="line">        $scope.ngModel = firstStatus || $scope.ngModel;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $scope.ngModel = firstStatus;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ($scope.noText) &#123;</span><br><span class="line">        $scope.text = [<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>];</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!$scope.noText &amp;&amp; !$scope.text) &#123;</span><br><span class="line">        $scope.text = [<span class="string">&#x27;on&#x27;</span>, <span class="string">&#x27;off&#x27;</span>];</span><br><span class="line">      &#125;</span><br><span class="line">      $scope.changeSwitch = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        $scope.ngModel = !$scope.ngModel;</span><br><span class="line">        <span class="keyword">if</span> ($scope.onChange) &#123;</span><br><span class="line">          <span class="keyword">if</span> ($scope.onChange($scope.ngModel, $scope.item) == <span class="literal">false</span>) &#123;</span><br><span class="line">            $scope.ngModel = !$scope.ngModel;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">      $scope.getText = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $scope.text[$scope.ngModel ? <span class="number">0</span> : <span class="number">1</span>];</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;switch-select&quot;</span> <span class="attr">ng-click</span>=<span class="string">&quot;changeSwitch()&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;switch-bg&quot;</span> <span class="attr">ng-class</span>=<span class="string">&quot;&#123;true:&#x27;on&#x27;,false:&#x27;off&#x27;&#125;[ngModel]&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">ng-bind</span>=<span class="string">&quot;getText()&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;switch-btn&quot;</span> <span class="attr">ng-class</span>=<span class="string">&quot;&#123;true:&#x27;on&#x27;,false:&#x27;off&#x27;&#125;[ngModel]&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*按钮大小不符合可根据需要在相关页面css自定义大小*/</span></span><br><span class="line"><span class="comment">/* demo:</span></span><br><span class="line"><span class="comment">.[class] .switch-select &#123;</span></span><br><span class="line"><span class="comment">        width: 45px;</span></span><br><span class="line"><span class="comment">        height: 16px;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    .[class] .switch-bg &#123;</span></span><br><span class="line"><span class="comment">        border-radius: 18px;</span></span><br><span class="line"><span class="comment">        font-size: 12px;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        .[class] .switch-bg span &#123;</span></span><br><span class="line"><span class="comment">            top: 1px;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        .[class] .switch-bg.on span &#123;</span></span><br><span class="line"><span class="comment">            left: 6px;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        .[class] .switch-bg.off span &#123;</span></span><br><span class="line"><span class="comment">            right: 6px;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    .[class] .switch-btn &#123;</span></span><br><span class="line"><span class="comment">        top: 1px;</span></span><br><span class="line"><span class="comment">        height: 14px;</span></span><br><span class="line"><span class="comment">        width: 14px;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        .[class] .switch-btn.on &#123;</span></span><br><span class="line"><span class="comment">            left: 30px;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        .[class] .switch-btn.off &#123;</span></span><br><span class="line"><span class="comment">            left: 1px;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="selector-class">.switch-select</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">vertical-align</span>: top;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">45px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.switch-bg</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">18px</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">text-transform</span>: uppercase;</span><br><span class="line">  <span class="attribute">transition</span>: All <span class="number">0.3s</span> ease;</span><br><span class="line">  -webkit-<span class="attribute">transition</span>: All <span class="number">0.3s</span> ease;</span><br><span class="line">  -moz-<span class="attribute">transition</span>: All <span class="number">0.3s</span> ease;</span><br><span class="line">  -o-<span class="attribute">transition</span>: All <span class="number">0.3s</span> ease;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.switch-bg</span> <span class="selector-tag">span</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">1px</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.switch-bg</span><span class="selector-class">.on</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#00af2c</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#068506</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.switch-bg</span><span class="selector-class">.on</span> <span class="selector-tag">span</span> &#123;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">6px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.switch-bg</span><span class="selector-class">.off</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#ed5b49</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#d2402e</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.switch-bg</span><span class="selector-class">.off</span> <span class="selector-tag">span</span> &#123;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">6px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.switch-btn</span> &#123;</span><br><span class="line">  <span class="attribute">transition</span>: All <span class="number">0.3s</span> ease;</span><br><span class="line">  -webkit-<span class="attribute">transition</span>: All <span class="number">0.3s</span> ease;</span><br><span class="line">  -moz-<span class="attribute">transition</span>: All <span class="number">0.3s</span> ease;</span><br><span class="line">  -o-<span class="attribute">transition</span>: All <span class="number">0.3s</span> ease;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#eee</span>;</span><br><span class="line">  <span class="attribute">background</span>: linear-gradient(<span class="number">#eee</span>, <span class="number">#fafafa</span>);</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">14px</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">1px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">14px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.switch-btn</span><span class="selector-class">.on</span> &#123;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">30px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.switch-btn</span><span class="selector-class">.off</span> &#123;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">1px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.switch-btn</span> <span class="selector-class">.switch-btn-content</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#dedede</span>;</span><br><span class="line">  <span class="attribute">background</span>: linear-gradient(<span class="number">#dedede</span>, <span class="number">#cacaca</span>);</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">9px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">9px</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">5px</span>;</span><br><span class="line">  <span class="attribute">margin-left</span>: <span class="number">5px</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>加入文件, 替换 input, 简单好用, 给老大看效果也还不错, 写好文档和使用方法,<br><code>&lt;div switch-btn ng-model=&quot;item.isTagEnum&quot; no-text=&quot;true&quot;&gt;&lt;/div&gt;</code><br>交差完工.</p>
<h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><p>过了两天, 突然发现在表单里面刚刚加载完表单以后点击按钮没有反应, 需要等个 2-3s 才有事件. 开始以为是 ng-repate 的性能问题, 一个 repeat 里面指令太多, 试试 trackby - 无效, 试试减少其他元素(因为之前对填入的数据都加了一个 autoInputTips 的)- 无效, 最后发现只是循环这一个指令都比较慢, 而且数据量越少越快, 感觉很奇怪, 断点到指令的 link, 也发现 link 加载顺序不对, 大概有 2-3s 延迟才执行这个指令的 link, 换成其他指令, 即使很复杂的, 也没有出现加载缓慢的情况.</p>
<h3 id="排查"><a href="#排查" class="headerlink" title="排查"></a>排查</h3><p>仔细排查这个指令和其他指令的不同…一点点删改, 发现删除了<br><code>css: &#123; href: &#39;styles/common/switchBtn.css&#39;, persist: true &#125;,</code><br>之后, 指令加载就正常了. 确定是 angularcss 的问题. 给指令加 compile. 去看 network, 发现 css 请求是在 controller 和 prelink 执行完了以后执行的, 于是感觉是因为 css 延迟加载导致指令加载顺序异常.</p>
<h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><p>去看 angularcss 源码, 在 650 行左右</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> directive = $delegate[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">var</span> compile = directive.compile;</span><br><span class="line"><span class="keyword">if</span> (!directive.css) &#123;</span><br><span class="line">  directive.css = $directive.css;</span><br><span class="line">&#125;</span><br><span class="line">directive.compile = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> link = compile ? compile.apply(<span class="built_in">this</span>, <span class="built_in">arguments</span>) : <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">scope</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> linkArgs = <span class="built_in">arguments</span>;</span><br><span class="line">    $timeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (link) &#123;</span><br><span class="line">        link.apply(<span class="built_in">this</span>, linkArgs);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    $rootScope.$broadcast(<span class="string">&#x27;$directiveAdd&#x27;</span>, directive, scope);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">return</span> $delegate;</span><br></pre></td></tr></table></figure>

<p>果然如同猜想, 在指令有 css 的时候, angularcss 改写指令的 compile 方法, 返回的新的 postlink 在$timeout 函数里面执行原始的 link, 所以才导致了 link 函数加载顺序异常.</p>
<h3 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h3><p>确定原因以后解决起来就简单了, 去掉组件的独立引用 css, 合并到 common.scss 里面, 在 index 里面引入. 顺便提醒各项目组尽量少使用独立的 angularcss, 而且只在各自的顶级指令里面使用 angularcss, 会改变加载顺序而且由于使用 timeout, 会影响性能.</p>
<h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p><img src="/images/more-teacher.jpg"></p>
<p>改完以后基本使用没问题, 性能也还 ok, 因为也使用的 ng-model 传入值, 用起来感觉和原始 input 差不多, 但是有个问题, 传入的值如果不是对象而是值的时候, 会因为改变的是值而不是对象绑定不到原始值上. 比如<br><code>&lt;div switch-btn ng-model=&quot;isDisplay&quot; no-text=&quot;true&quot;&gt;&lt;/div&gt;</code><br>在 switchBtn 指令里面改变$scope.isDel 的值则不会改变原始 scope 里的值, 因为这样传递 scope 是值传递.</p>
<p>那怎么解决呢? 很简单, 用$scope.$parent 来取到原始节点的 scope, 然后改变值就可以了.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="regexp">/\./</span>.test(attr[<span class="string">&#x27;ngModel&#x27;</span>])) &#123;</span><br><span class="line">  $scope.$parent[attr[<span class="string">&#x27;ngModel&#x27;</span>]] = value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>看到这里可能有人有疑惑… 如果在 ngIf 下面使用, 还是会绑定不到值啊?<br>是的… 可是原本的 input NgModel 就存在这个问题, 为了统一, 也不准备修复<br>原理是 ngIf 创建了自己的$scope:true 的原型继承作用域, 虽然可以通过原型拿到值, 但是绑定的时候还是绑定不到原型链上的.</p>
<h3 id="后记的后记"><a href="#后记的后记" class="headerlink" title="后记的后记"></a>后记的后记</h3><p><img src="/images/more-teacher.jpg"></p>
<p>后来我用的时候嫌麻烦, 改成了最简单的 css 实现.</p>
<p>效果:</p>
<style type="text/css">
    .mui-switch {
        width: 52px;
        height: 31px;
        position: relative;
        border: 1px solid #dfdfdf;
        background-color: #fdfdfd;
        box-shadow: #dfdfdf 0 0 0 0 inset;
        border-radius: 20px;
        border-top-left-radius: 20px;
        border-top-right-radius: 20px;
        border-bottom-left-radius: 20px;
        border-bottom-right-radius: 20px;
        background-clip: content-box;
        display: inline-block;
        -webkit-appearance: none;
        -moz-appearance: none;
        user-select: none;
        outline: none;
    }

    input[type="checkbox"].mui-switch:focus {
        outline: #fff none 0;
    }

    .mui-switch:before {
        content: '';
        width: 29px;
        height: 29px;
        position: absolute;
        top: 0px;
        left: 0;
        border-radius: 20px;
        border-top-left-radius: 20px;
        border-top-right-radius: 20px;
        border-bottom-left-radius: 20px;
        border-bottom-right-radius: 20px;
        background-color: #fff;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
    }

    .mui-switch:checked {
        box-shadow: #64bd63 0 0 0 16px inset;
        /*border-color: #64bd63;
        background-color: #64bd63;*/
        border-color: #52a4ff;
        background-color: #52a4ff;
    }

    .mui-switch:checked:before {
        left: 21px;
    }

    .mui-switch.mui-switch-animbg {
        transition: background-color ease 0.4s;
    }

    .mui-switch.mui-switch-animbg:before {
        transition: left 0.3s;
    }

    .mui-switch.mui-switch-animbg:checked {
        box-shadow: #dfdfdf 0 0 0 0 inset;
        /*background-color: #64bd63;*/
        background-color: #52a4ff;
        transition: border-color 0.4s, background-color ease 0.4s;
    }

    .mui-switch.mui-switch-animbg:checked:before {
        transition: left 0.3s;
    }

    .mui-switch.mui-switch-anim {
        transition: border cubic-bezier(0, 0, 0, 1) 0.4s, box-shadow cubic-bezier(0, 0, 0, 1) 0.4s;
    }

    .mui-switch.mui-switch-anim:before {
        transition: left 0.3s;
    }

    .mui-switch.mui-switch-anim:checked {
        /*box-shadow: #64bd63 0 0 0 16px inset;
        background-color: #64bd63;*/
        box-shadow: #52a4ff 0 0 0 16px inset;
        background-color: #52a4ff;
        transition: border ease 0.4s, box-shadow ease 0.4s, background-color ease 1.2s;
    }

    .mui-switch.mui-switch-anim:checked:before {
        transition: left 0.3s;
    }

        .mui-switch.mui-switch-middle {
            height: 26px;
            width: 44px;
        }

            .mui-switch.mui-switch-middle:before {
                width: 24px;
                height: 24px;
            }

            .mui-switch.mui-switch-middle:checked:before {
                    left: 18px;
            }
        }
    }
</style>

<input class="mui-switch mui-switch-animbg mui-switch-middle" type="checkbox" />

<p>代码</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.mui-switch</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">52px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">31px</span>;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#dfdfdf</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fdfdfd</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">#dfdfdf</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> inset;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">border-top-left-radius</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">border-top-right-radius</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">border-bottom-left-radius</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">border-bottom-right-radius</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">background-clip</span>: content-box;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  -webkit-appearance: none;</span><br><span class="line">  -moz-appearance: none;</span><br><span class="line">  user-select: none;</span><br><span class="line">  <span class="attribute">outline</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">input</span><span class="selector-attr">[type=<span class="string">&#x27;checkbox&#x27;</span>]</span><span class="selector-class">.mui-switch</span><span class="selector-pseudo">:focus</span> &#123;</span><br><span class="line">  <span class="attribute">outline</span>: <span class="number">#fff</span> none <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.mui-switch</span>:before &#123;</span><br><span class="line">  content: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">29px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">29px</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0px</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">border-top-left-radius</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">border-top-right-radius</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">border-bottom-left-radius</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">border-bottom-right-radius</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">1px</span> <span class="number">3px</span> rgba(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.4</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.mui-switch</span><span class="selector-pseudo">:checked</span> &#123;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">#64bd63</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">16px</span> inset;</span><br><span class="line">  <span class="comment">/*border-color: #64bd63;</span></span><br><span class="line"><span class="comment">    background-color: #64bd63;*/</span></span><br><span class="line">  <span class="attribute">border-color</span>: <span class="number">#52a4ff</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#52a4ff</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.mui-switch</span><span class="selector-pseudo">:checked</span>:before &#123;</span><br><span class="line">  left: <span class="number">21px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.mui-switch</span><span class="selector-class">.mui-switch-animbg</span> &#123;</span><br><span class="line">  <span class="attribute">transition</span>: background-color ease <span class="number">0.4s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.mui-switch</span><span class="selector-class">.mui-switch-animbg</span>:before &#123;</span><br><span class="line">  transition: left <span class="number">0.3s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.mui-switch</span><span class="selector-class">.mui-switch-animbg</span><span class="selector-pseudo">:checked</span> &#123;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">#dfdfdf</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> inset;</span><br><span class="line">  <span class="comment">/*background-color: #64bd63;*/</span></span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#52a4ff</span>;</span><br><span class="line">  <span class="attribute">transition</span>: border-color <span class="number">0.4s</span>, background-color ease <span class="number">0.4s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.mui-switch</span><span class="selector-class">.mui-switch-animbg</span><span class="selector-pseudo">:checked</span>:before &#123;</span><br><span class="line">  transition: left <span class="number">0.3s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.mui-switch</span><span class="selector-class">.mui-switch-anim</span> &#123;</span><br><span class="line">  <span class="attribute">transition</span>: border cubic-bezier(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>) <span class="number">0.4s</span>, box-shadow cubic-bezier(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>) <span class="number">0.4s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.mui-switch</span><span class="selector-class">.mui-switch-anim</span>:before &#123;</span><br><span class="line">  transition: left <span class="number">0.3s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.mui-switch</span><span class="selector-class">.mui-switch-anim</span><span class="selector-pseudo">:checked</span> &#123;</span><br><span class="line">  <span class="comment">/*box-shadow: #64bd63 0 0 0 16px inset;</span></span><br><span class="line"><span class="comment">    background-color: #64bd63;*/</span></span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">#52a4ff</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">16px</span> inset;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#52a4ff</span>;</span><br><span class="line">  <span class="attribute">transition</span>: border ease <span class="number">0.4s</span>, box-shadow ease <span class="number">0.4s</span>, background-color ease <span class="number">1.2s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.mui-switch</span><span class="selector-class">.mui-switch-anim</span><span class="selector-pseudo">:checked</span>:before &#123;</span><br><span class="line">  transition: left <span class="number">0.3s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.mui-switch</span> &#123;</span><br><span class="line">  &amp;<span class="selector-class">.mui-switch-middle</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">26px</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">44px</span>;</span><br><span class="line"></span><br><span class="line">    &amp;:before &#123;</span><br><span class="line">      width: <span class="number">24px</span>;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">24px</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &amp;<span class="selector-pseudo">:checked</span> &#123;</span><br><span class="line">      &amp;:before &#123;</span><br><span class="line">        left: <span class="number">18px</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &amp;<span class="selector-class">.mui-switch-small</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">22px</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">36px</span>;</span><br><span class="line"></span><br><span class="line">    &amp;:before &#123;</span><br><span class="line">      width: <span class="number">20px</span>;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">20px</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &amp;<span class="selector-pseudo">:checked</span> &#123;</span><br><span class="line">      &amp;:before &#123;</span><br><span class="line">        left: <span class="number">14px</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;mui-switch mui-switch-animbg mui-switch-middle&quot;</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">ng-model</span>=<span class="string">&quot;item.isDisplay&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
</div><div class="article-licensing box"><div class="licensing-title"><p>一个angular指令加载顺序异常的排除</p><p><a href="https://mosby-zhou.github.io/2016/09-04-angularjs-css-directive-link-error/">https://mosby-zhou.github.io/2016/09-04-angularjs-css-directive-link-error/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>Mosby</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2016-09-04</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2016-09-10</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/javascript/">javascript</a></div><!--!--></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="/img/alipay.png" alt="支付宝"></span></a><a class="button donate" href="https://www.buymeacoffee.com/mosby" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>送我杯咖啡</span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="/img/wechatpay.png" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2016/10-23-angularjs-async-module/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">angular的异步加载组件以及路由使用</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2016/08-18-angularjs-provider/"><span class="level-item">angularjs provider的区别和使用</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><div id="comment-container"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js"></script><script>var gitalk = new Gitalk({
            id: "296234637176c96aba60179356d4378f",
            repo: "mosby-zhou.github.io",
            owner: "mosby-zhou",
            clientID: "16bcda17da1d8096c181",
            clientSecret: "eeca61cbccf5f011dc54308ffa8dbfba816efe32",
            admin: ["mosby-zhou"],
            createIssueManually: false,
            distractionFreeMode: false,
            perPage: 20,
            pagerDirection: "last",
            
            
            enableHotKey: true,
            language: "zh-CN",
        })
        gitalk.render('comment-container')</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="Mosby"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Mosby</p><p class="is-size-6 is-block">Full stack development</p><p class="is-size-6 is-flex justify-content-center"><a class="link-muted" target="_blank" href="https://www.amap.com/search?query=%E5%B9%BF%E5%B7%9E"><i class="fas fa-map-marker-alt mr-1"></i></a><span>Guangzhou</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">83</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">21</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">9</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/mosby-zhou" target="_blank" rel="noopener">关注我</a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#起因"><span class="level-left"><span class="level-item">1</span><span class="level-item">起因</span></span></a></li><li><a class="level is-mobile" href="#问题"><span class="level-left"><span class="level-item">2</span><span class="level-item">问题</span></span></a></li><li><a class="level is-mobile" href="#排查"><span class="level-left"><span class="level-item">3</span><span class="level-item">排查</span></span></a></li><li><a class="level is-mobile" href="#原理"><span class="level-left"><span class="level-item">4</span><span class="level-item">原理</span></span></a></li><li><a class="level is-mobile" href="#解决"><span class="level-left"><span class="level-item">5</span><span class="level-item">解决</span></span></a></li><li><a class="level is-mobile" href="#后记"><span class="level-left"><span class="level-item">6</span><span class="level-item">后记</span></span></a></li><li><a class="level is-mobile" href="#后记的后记"><span class="level-left"><span class="level-item">7</span><span class="level-item">后记的后记</span></span></a></li></ul></div></div><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Code/"><span class="level-start"><span class="level-item">Code</span></span><span class="level-end"><span class="level-item tag">9</span></span></a><ul><li><a class="level is-mobile" href="/categories/Code/Others/"><span class="level-start"><span class="level-item">Others</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Code/Programming/"><span class="level-start"><span class="level-item">Programming</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Code/Regex/"><span class="level-start"><span class="level-item">Regex</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Code/Sql/"><span class="level-start"><span class="level-item">Sql</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Computer-Science/"><span class="level-start"><span class="level-item">Computer Science</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Server/"><span class="level-start"><span class="level-item">Server</span></span><span class="level-end"><span class="level-item tag">11</span></span></a><ul><li><a class="level is-mobile" href="/categories/Server/Docker/"><span class="level-start"><span class="level-item">Docker</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Server/Egg/"><span class="level-start"><span class="level-item">Egg</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/categories/Server/File-System/"><span class="level-start"><span class="level-item">File System</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Server/Others/"><span class="level-start"><span class="level-item">Others</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Web/"><span class="level-start"><span class="level-item">Web</span></span><span class="level-end"><span class="level-item tag">61</span></span></a><ul><li><a class="level is-mobile" href="/categories/Web/Angularjs/"><span class="level-start"><span class="level-item">Angularjs</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Web/CSS/"><span class="level-start"><span class="level-item">CSS</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Web/ES6/"><span class="level-start"><span class="level-item">ES6</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Web/Extensions/"><span class="level-start"><span class="level-item">Extensions</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Web/JavaScript/"><span class="level-start"><span class="level-item">JavaScript</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/categories/Web/Next/"><span class="level-start"><span class="level-item">Next</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Web/React/"><span class="level-start"><span class="level-item">React</span></span><span class="level-end"><span class="level-item tag">39</span></span></a></li><li><a class="level is-mobile" href="/categories/Web/React-Native/"><span class="level-start"><span class="level-item">React Native</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Web/TypeScript/"><span class="level-start"><span class="level-item">TypeScript</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/css/"><span class="tag">css</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker/"><span class="tag">docker</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/egg/"><span class="tag">egg</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/javascript/"><span class="tag">javascript</span><span class="tag">20</span></a></div><div class="control"><a class="tags has-addons" href="/tags/others/"><span class="tag">others</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/programming/"><span class="tag">programming</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/react/"><span class="tag">react</span><span class="tag">40</span></a></div><div class="control"><a class="tags has-addons" href="/tags/react-native/"><span class="tag">react-native</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sql/"><span class="tag">sql</span><span class="tag">3</span></a></div></div></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.png" alt="Mosby" height="28"></a><p class="is-size-7"><span>© <span id="footer_site_year">2021</span> Mosby</span><br><span id="busuanzi_container_site_uv">共<span id="busuanzi_value_site_uv">0</span>个访客</span></p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-CN");</script><script>var ThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/mermaid.min.js" defer></script><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>